// Copyright 2021 The go-ethereum Authors
// This file is part of the go-ethereum library.
//
// The go-ethereum library is free software: you can redistribute it and/or modify
// it under the terms of the GNU Lesser General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// The go-ethereum library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public License
// along with the go-ethereum library. If not, see <http://www.gnu.org/licenses/>.

package types_test

import (
	"bytes"
	"fmt"
	"io"
	"math/big"
	mrand "math/rand"
	"testing"

	"github.com/theQRL/go-zond/common"
	"github.com/theQRL/go-zond/common/hexutil"
	"github.com/theQRL/go-zond/core/rawdb"
	"github.com/theQRL/go-zond/core/types"
	"github.com/theQRL/go-zond/crypto/pqcrypto"
	"github.com/theQRL/go-zond/rlp"
	"github.com/theQRL/go-zond/trie"
)

func TestDeriveSha(t *testing.T) {
	txs, err := genTxs(0)
	if err != nil {
		t.Fatal(err)
	}
	for len(txs) < 1000 {
		exp := types.DeriveSha(txs, trie.NewEmpty(trie.NewDatabase(rawdb.NewMemoryDatabase(), nil)))
		got := types.DeriveSha(txs, trie.NewStackTrie(nil))
		if !bytes.Equal(got[:], exp[:]) {
			t.Fatalf("%d txs: got %x exp %x", len(txs), got, exp)
		}
		newTxs, err := genTxs(uint64(len(txs) + 1))
		if err != nil {
			t.Fatal(err)
		}
		txs = append(txs, newTxs...)
	}
}

// TestEIP2718DeriveSha tests that the input to the DeriveSha function is correct.
func TestEIP2718DeriveSha(t *testing.T) {
	for _, tc := range []struct {
		rlpData string
		exp     string
	}{
		{
			rlpData: "b91c3e02f91c3a010380018261a894b94f5374fce5edbc8e2a8697c15331677e6ebf0b0a825544c0b90a207d87de68b6a9e476785e8444c253e78b0ca3ef9413dbc673ba62fc47bac1003421ddce3aadb4a1ffaa79d9a91e65d81bf203e5207ced88153c10020512f84c7d78ea6e97e94bdf6bb9e9b750b63fa501355e19fa319ec4024dbbde5dda6d011eed6ce3b14efe488d9b8b3b782231a63e7fdd7b22e433dac65e49ac2e2e3c10a54ce384887a03b98759701fa84cd7ba9d1e1dd90309bc693c5fb8a894c8822b008f3b0f01f560fb011a6e024b6117cbc5eac6de111da5066797afe8145a62766b01e003554e8fc08097a5cb543c51e8c8b1f56b9c38ec7cf9517e6c0e9aee1f504ccad2dce8f801cf9a0b9150d7f6b225d14369f80c1fcee36276f1a0ca108d8ff1687bfaf95266b866c7036430db7900bb50cfe11743180643069df2b278e530ee5f797fd83d8c45fc86eed5d43f6e8c03856f407eb6064dc2d43d45c81c445760584d62c54f201b788aadf5b1ab995e2441413313f7f851ef29baba8f941023c008bbdec58de8b8d60eab199d0ec1e868997ce13d54212e3908fd287f91f6c141fd086d21d5029edbc10d4b52257b25b8a4badb5db366a9284a36788c01f76d95cd34f1d638e90102aa9d0d38a5b555d38e48972d12b099bdcc5daa5262c639e023470306ca8e9d3309e977de9eab71f60d404511335ff158d161e05028e8ea02f834415d95d9951e1d9f06f5b57c25072de43990f06b53ad4df7e9c9279e68326459016f8117aeee35658154607c3c981a76b87c4e75d12d96f877f3b7f47536d1720acb9333db1f76437d8dec247c80528b7ed7e8af92e103c3eb5aa3ba81ce56c23932317a9c8eade68c0342373887f803fc87a667b587dc476aa59086a3045219fe2f7c611a8666215e348177cbe7ca45da8b07ae1842cca020ce7013e83e138efb62eeff88c7e2fb76a1a957d1f02d26d63003c4db6bd4ad6174db1e0502121a899587a0aa049a77a5387569794e414bebeae02295efacfb43b02b94e0268e44c9cfe2f14edfc9058a158aa4dae58b23dd96a915f8942d5b51f81fdc1e45b1985b8f717d84145611f676e3712f5406d7095d8c3d2ebfe17a722d55907e64bba4ee5514fe70071ac03e4f5afaf049a0f24a42cd3a5c68a509a157ac1af2d28864dc66302103c21c52dbd9e6f6f8487d637cd2f3279a2a6fd6b172ef0280768061b0718621dfc0af37f7079fc400e4594d01243c2158fc318dfb5fb9bd3036a4dfa1b52e551a639468b75940028c32accf4d6fef6dc2d9efbe88b4899f9384407bf0cd50d92bed94a14c40d5ae3076ff6284bf214b4b177db663aef6d9ff5ab394bc985f3bdea1e0beace1f5fa0230cf53e57473f50a6610a677a1281d9676001f214bc3cf0987a82424e87e0e7e5237606e60e71f3a92400ac95c0c660015e1b9324aa4b1231c138b35195add8dc4002c26648bc5707c7537623d046281c5597385a87d5bd92060ee6ddc3efa34daf49ffac27cf7a48697f7a1a00ad3cc2d9ee66e67786763ccb086e15cb6d9c868f6072f7d9b6970cadeb1773700c54d2f197e5cc6c6a89d1823fedb207d0b49efc8158f3592efce23046774b03673fb88911af0735c185b94a5f44edee34cc99d1d064808c119bb6a4c90635206b0f440beb519721eadb4df66458655ef3cc4033d7ae8aa0cbf7b7b8f6ae8321a5c26d4964fb01d331ffec57a93a017f0322fea991a93b7e988aea9fd763365b6f4596623ea49692e76bf5dc405de914c14612348076d93bc0a83286974a9a615edfe2da2a7e4f60e15a088b0550afd4aea994d00bc88c20c0cfee38aa57d67736ea2f59698a02ec7174fb5d42e9c6f7520e30b2c386fca2b8fe9ba1e6e79a42a3586670f16ae2138c12ece2e35c74bc0ea4d6199c818f58cb7b4d12419b4af016eb73e60128b70d6092ada8aa8cf2c419208ec39e5cad3ea99f497682d4991b7bc28a2dfb987ef4a72ace24903d7ab72c5c9dfca68179c95165bff6c77558edd55adea46b191763b0b0ee33cfd5ba61a04b425a463230a8297ce46d18e5825c740e8ec1bf56d2cbfa639eb904465f9dc67757eeedc83d61c1684aa67609465a295aead7da61ae97287e7f26e5c541fe932a972c4ab600b4ebd96b55e6a4de291e7d0e8135b9ad1c6283e12d0398f5f2a608a4e56a4955cda77ecc0f8f0fdebad91e65c763bd24f8459e761290974d8ec5ec43974cc89dee08329b8a62d71c411a3d3bd738cd14ac72dceb69d59c33ad974dff0b2cdc6b7cb092c48091c65d4f380288f2a1c3ff643f836447f0e094e12e1d0fed622afce581bb128454efdcfe61dd3767c8d5651ee3cbf79478c467e113866026241b31f5c570abb06ac723bd71d97332cacdd2203951418513f1215fd6fbd4210992087e12558b78fc8a5a921ecff8bacc9ef43f7992be7549207db7261df8a7cd04e18f2cea3e0157a9773cbb6b5d5bfe76ebd6d2141c9ce293e88ea821ef2054a749cf078d1c3b5214b336f883384dd9e4c91113410324051b95d1215de8e552f52e6a3045eec54b725af1a9e884f0ef8ed549e72f54e641e5841d1150eed9bb94be65c3462e02121330acf3f7f0e506f9951fea984fa936eb77e366e4f0e0fc456175c3e81451489cdd8d2f8d7c82ae84cd1805fc8673b1550b736cca2a321b79e185e9b39161b415e670af5f7073dccc4e81387d2eb317aa3a68634191ed4e3791dc0b23a4ac20b0d037224ecd142dd4e69fb2a85911dd9cc6165d4ceef7c24347d1215d4cf4de9ccc04578a6923c589b11604e35abcb553d9a3a62a42e5024a9f6cf1028e5255b957bf1e179812be14100d7cef389a6476ce90a07823f8eef6cde33bf8812bfd89bfc16505150335d715f6c77f50960d529781d965f504da192d6fb503a929641495c2c9d18d8879d33a00640ecfe1611ef0e84d36feb4f0d9276376358046c9edaee456af4ca934c0ca1e95ef657fbf2df2e30c722903e4c76a9c44a6860e6d4c23150a822850c61146e3c2334ba9c793620f95063462dca4028556ce81dec2c24d00b1230b2065100def043b37c2b951a3cb2b32220438f45d1058d396f55a87993ea1b1cc0b4aa9c85ff3182879f3a88c076f455c68e042089b6d35f9b5f99290660cbe249bdf20639282dc7b6d9fc2cccdb0db76134cf0fb932b20a50afe37814a5f76e8be39211603573fbf34be3d8a234bd03a93a8afc41e91b1fc9f51622ea90dbb28dbc64a7f3bdb594f75d9fbc6ea98d50d2df4f2cc28bee17d41174bb0392cab1183c95b747562578eb131042a2d67532fbdc1b0154fc20f7d9337e2ce6f68fb859783f9f27b66af00637b12d37ba40e0afa527b7e61ae878fb131a5452082e72201fadb36f1e24ce5ed087ccbad519a0745185bff4890e5daf135d32d9aa0c340fd7ceed1ada1d47fa8a737de0e47009fbbf717c3c471fe11283b694b687540891da1b9728a5b6deee6481e680521f498d6162093bc03d6ff2ec4f6e80ba086f4909e6a7b9a2c5e59a0d9edabf3056c5b77c87371cde641e6126d588e4aa7929b76b6839e88f97afea1384dadc718b61b314939287ff1f6ec24017a233678b2f64dc65ce08b4b12e6f0f922393ec0d1c7962c5aa881fffe6a95275ec8cd4230f5303fa2ea3f9eefad704777dd2be4f398848622d21c8b6c3ba5050b3768e5bdfb911f3f34431a005b02801b954002b546f770217a02f7e911afcd81379368486c592e6857503dae235aef60177f88b2c603fd7cec9b2c7fc08612486e31d4777de6c5a0e9e0958019e88b46314b875a9cbfa18e33416fb0783e3d6e6ce02260db0d4215a92039b6eccd508cd5f32c76822a084b9bd1f708209f09c12761093ee9cc94675d78bc06ba1e61227d4cb5c0cd9caffdd9d1198485ef27311873173fa36db31a36e2d4cdd17021aee99c7200df53ebf168e11dcbfe9e58cf67836b37eed18e1580225d2f5dc6eb085f4e9cad4b8558f3981ad4f8de122d2f049cc8c50f2523e339bb7a4e80a11836fec6bb54686eb75456b194c2a1025486b4682c0753f32c9d01fa5e80e50aed572f11a20078dec9dc6f379d017eedd48921e892981e32d447e107cd5d9fa673a86f3488a393d910ceeccfb2cdd72079f2ead0250a54ce0c4270654e2202f63c314a9fd3ffa345348449ea2bab101b59d1bbe671a5d8278abf1a6f8fe5a447fa3bc79c7b666a7cb886cfeefc20d200e4dc2c2485ec85d185de33d816e182bb549041547b4e13373f8f9e797a4adc5f62d8446a641724e0977cae482320a72b2fdb2bcb36a0224afdaf779991e132349080461a3f1d1b03b3d1557709ad2c75edc707fc368ac8515e772c72e82ff5bfdfb585b9ee2ac06d3bdeb7e89bcaf299e2c80f5ad9248931f8971e5d9379634cf1a4141d193a403c6c3c52dab5b3a950d3144e4f02028730fc9083ef988fcaa903d5528c8a6a29eb3c8a34931521f95604e0a8c381a179bafecadf80876cfbe071bbcba1df675db4a90873a7f613be1a1b0cac58bc345f9da09b6c438903e34e9170202e40239577f3ca3a1a17b7849c10eb789a20266e44799fd0c6da8cc26ab6e03d881c5055358cfb9c94d6639b7e089ed34f7cf8b3bf2b3aa08d7fe4e5a6468cf22a446d11fb22d8fc3bb104d5138c9150d87c142f8a4432ccd5fa5b023cc174e4eccf876ad5a02d1276ccd3e600d5d69d6d6c324e45ba1e0ad7e0b4fffba85160e7de52fc0a509ac15f5ca1d78585249d570a4986adbdbc1d873b529a465d7df675419d823abf06bb7cac4549a9db0e7e365b4026ed1ef6b6d3d8c98daacd8091b8e74c8366e6628c885418a52e9b5d40c8100605c3b279ca20dd7298dead7f14f03b0e9d25cc2543bf5fc46a1825a1a1714a2a2e4e94507997e923b13e036ffbcffd41741d3ee2604586fe29593899fe73ee57e18706f835c4b7f4845ef759b767c88c272075a4080416d5292727477339ea5ce5a152cd66773e43701f94e0d2cfbe9e42a32aea4bfe2624c90cd9dafe9ac42e1fe7499b1bec1fefc05ac231cb3f3dfee7785924a6e99924b6e79257ebccc9fa2ffd8dcf4c29f829f2909facb38a3f85a8de8c866285d2a030c2bf50f86518c5548f980314ee90fac69fd9eab18fc1228bceb7f996b1a4e3584b7508afddf85bc8129293f853b2805dfdc81b4808381a84b80bc9b481722b90857ea2cd45f1845463e422855706925c1b6180f23d9df4cc6b15f95cc18871e7c6c1a65ba836ebf69ba38c0dcbd7b5267a3243739246de49934ef6738acb4d77018b8bef64aec9bdb3937442860dd89e68ae331522dadcb507ff5a02de1eb383cf47f3d4bbf32f83f369b2c8b9f9246bf3749cdc95e268f9e88ab49da37095bfe6a655feee1940a532d73817ed8f65d696edb6a0c5b0cc5755470dfa57296eea083e0b16bee0a21d5dc22e7ce8956c1c09dded654340e42fc9ae05c6f13df808df31715892562895bc238a3cea27700ab93a39072c778c7b280aab72b52b684acdb50ca2aa30845ae5c231599b80d7bb8a93422a3a6423f174cfaf9fea4f0c2dc91b8cadf4e7e335452f32715c88925ec98a24ba3027aeefa9c67d32f0ed75c8ec27197df2cea9eb437796614bd21410a778ecaedf7e9727b1cbf4741bdfbd74aaa41162c760da6d1603fab8f13d23fc936c732b01eb7771057ff144ac84b8f3b7b52047561d41cec8e7d2b232d8966c8410ddaf703c6b86479e3de8a9300f8ff4dc69dc4f88cd54807d22046f3ffe6398398d4c46c0bf8062ecde57d774c05bcdbf862b11aaa836db73fab0e12dfd9e151db61775c9fbf45f798108d39d280364b542f1dac236522f87c9df0d08783edb85187340b1ddcbfda183776929cface8589d55b9534e6f87e128def94a58515042b753275518ab3e63d305aea4f38b020d816dd867e91816f04af4e50a42604ee87d1084a6f6e9a368cb75d8be0db592fc686cc619afa012dcfcd0ebf5a2665e0ee428caebb4ec81c7285998be9fae1c0addae6f6d9322606e052e7c517472291ce63561e94b955899b2cb168d1a74e71a26fce5c05ed0d6f59d40a908a76e99352ad20ce3b82c0896814f6c7fa1b22dc766458d569925b3d0f17513d4458175b738d2f31f437fc30cba8f9c4e60d9e8c8aa74a569350276c6eb33785bb516490609d80b63126a8067ccbcff8a94f154ba9ee15d53f4f1a05e0dcd05ae2c5258464d5ba09f74245410112c781741745ad0d0662e7b6774fc0f20471645a1ac1e3bd3b16f06c7e02e779071d955b1f691877fd37d6af1e023d94383c621f6b7531a4742ac856181237b4bdf07811ea670e29b3b0e69a447651b9337d0bcf4b407b0d7bdd74afb2cb47cacb78574e46a5a12af625fe9c7ca119d596d7742dbba8df1b59836c867611e942df5565ad8aa07d56b8905de818ebddc9454154db4ec29602a5af41e61149bdccafb682b2afbd0ccb2ac7e941fff0c445cbdef5f9ec1cfb7cfab93d1a7da5ec66d321e5e3f97d2e30aabc5d520f27ca33bbdde1e8501ac2f0a714dab49189ea29f44b8def7cf3f46c8ab8bb557a9169639da9e7f2bead11d6e733b1e4f34454daf6dcdfd3151183c6f7e44882f7359807a6c79491b3be5e6a50d0e7f80d5a7e3b1c74d908203c5448bb4cbd22a79e20509a23a5ebc7d7e8d08c24659cbb21b01e5e476852dc3c237d1ba15d20986146e55a207656bca90eeaa9439fe648ef3abc13fd756880f7092f68e5933401efe5f76766722b8dbfe432e33587f29126d53723dd7aa17510784ebd1329ad312442a9fb891d523279a69fa9a69e6a6ea3b4b568a2683de827aebfea62250616fe36ad1b856b1d93454f444ba63bb2c35ae54d859bb34934a70e3d9ce30204f75fcf6ae53f6af2cf272c8ac894f874754609988bde2197f0f2f76c8593103dfdc1b9e0675aa342bcd10128a868f8a73a312a71805c0e72792827a85bebfa30f18ba24080aa0c3c4ea863758b9cbc8f61faa255e07559311b70e996fe2b555d2e71b754fae720f050c73efcd6078d142e574a16349cf77fa59334391215107f779ad0be52cc441cd5dc366249cd4ed9aeff64db520fe0aea0811963b17e42d42e6e3b600a8bff2aed2ff4a1e7b53fe1212ddc5369bd73b714c279a9d906b7821e7e5ad5ea9589562852cfaf9fe2ace553bb1489b799824a0b18336170fac7795a4ed2d285679749055ab992f7217d2622f6d07a74190e906c24c7b3f6c4dfe73b97c0f47cc272880b2fca5bd45183c85f93be1d9afcdc3145c714065e5b9efa5c1b4bda2900a720fcc4970bce297fa040f25dc413f60819eac855dc7714eb545e001c326f06e8f05b64f1e1f498a37ec69f8c92710edd05dec1f8d9b68dd8d0eff460e18de762bc397738f736442f3777e45e8937f4358cd9104e2d505cad9be44fe275ff37d42f93b4516ce8d8ccaf37feeaef3636c9f990ffcf7dacaa9a6ad94dd2d294de3a531848c11e70b39cb6e9581996861259749c0c12f20fdfafd9e3ba8a13465272dcd68c069a7c74407dbbbc2e190708f433cb51f7761ed9bd085991a2a634bb2d88ae12321e5bf730532e23fae44176cb13b82a06c39a0bf4148c3496cbca12609ec842a6e1c7ab521dc273e3b1768bd8e56a3babf055334da926f6438ccc8c382eb2331f5dd99b6921313f16e6afcc3a88da1a61535030ad64815ad179f64d5c764e148dc674f671a7dce09cc40ae6d2eec2d308bea65c8329b2bdd0cbb0c442153266eabe10c1238efba7c7996234eeb050ad47e10ad26be1d356a491a023e80df634f9279d450109b9dcc69740a55d5be2cd6c20ad9bd8967d62255cf44ac59add5ba54818d6e4d5cde5aa03de4b867a10d35e6d365d0931bfdd0592dc17ac64a80da4b67bb5387cc4d9fadaa1394b2a46eaa07f2aba2b6209de3eec706290c27f102a772375505469fd59162ce58bbcf87ac64d33a803939525bf11c5170d90286bc0e0114827d13246d9ed69e16d9616af22e8451c3522ad524801454d5c25f3abcbc1a3e2055e6959136c6b01ee775fa6917ae1a674bc4129a973d5e347f2df66031414e3e40cef7c02432b7ea9c758fb2dc88647cef4eb093ddc8a359180412c16f6ca4726e3cde3262c4019df888b430ce7728fe508e083bcb6f3384fb4609b56c0c18b431a06a1a6072dbd7a86d72af95235ee4f71cfb8ffac52a0c3b0af0a233eaf2005dee1aa685c10729cb500a459eec491bf76b36767f913d053d0867ba3f0f5801f6c0084ffc2d29f9086796e31c88c94ffc7a9230397bdaca1df3d80dd45c12259495b1fcf7e0f8eeef72d716285487ca89eb048dba9217389041258acf4b55162d2c4abd617347a5cd8c64b014d0f383e2ba012599e3cb1cb1691ac5b828e9f5ad41f9cfb3ee19c80759d501f64171c4352f8b20c3b7cb7d6324e661c4744bfeaf557eedc90df09794d92a6a7e14eeb68380c3df5aa701e0bf94f39af6eb9633709a55eb971bb8929233d6ab9e988ce6ca2b590562d4186861e6212ef51717a6271b5940a452cf2954abcc08ef3b41ef60e4d96d160b1f4d72ee332c8271ca497e2cdb2e7b0412c7b9b64892b47a40f42a22e41eabbd6d3b6af43cd44f8fc03739c2bd0ad7fcb6a944fe7020d40d8b83bf261d05f30ce0a6ef5489de89b76a071ebebcbda578c8bfa30082d8f0ab9d93cd5866a3b52024e5eae194697620838f9f4b4fa2889bf21095097008b661cc9c9eba1761c6ae98fc99a429afae9ec3a2c56631cebc6fa3d92c5b5fa7cf5a008cff849ded723adb0a8a2be019dffebd73b8aaab4f4e0e1eac01ce5c284cec7afa720175b42fbbc819561672890f636203b104fbc40f8f6467ad6f268e99cd51600ad0cfaa7b54d6ff86bf049443e619968209a63576d0953c810669d7c89cbcb0927eab931529e84403e1faff58f6ace6d4e11c7b892290760009e950d94e6d68fa38180009fb92bab34c88e931023885400d9efa67e85d7111905eb5cf9232bb860816085054e62e13e85a5e627116fa550c005ce14e585ca27807cd70b78e7eae4520ee4fa7218d335dc44ed9cebf68c2571e239391b76ea6286b303e2045a1803679b268a2214546aa336c25dcc75a866f11d16eef7f0b378815aff07835a60a916d6c1e0e3ddb512251d4c116f5ca7e53c23a65496e47a62e4f313a228a0c2bf9362f655d3b055dad7a7bdec6cb0d4bacd81c7fd7b15189beb668f3d91e7920e22589eb6549c23e69baac979159ae6bea9164edae4cc77aefbdb0fd08b2faebca0662be878de5dbb9b4ff740acad09d78d5cd38a3bb895d12dbe6535fde2a736b6a35f7acbf7dfad9e79bfe7287c1836c594f8bc52672a6916185f4059773580c679ecd6d6c5ad0c4aac09c8d402395ce31e3647f91e98dc898efb59e1b9d5726e2621930c1d4443e7e7985cef9aaccdd58474d248ea465bdd093c590ebaf727437879051d1c357a63f01b66fb607607cfc6fb32cc22ad7be845df3646a46c03cac7e3c4cd750f04ff5320688db246f2487ad553b3112207d2b22ef1a41929bbd1e3202488b16f0832b06b891cb3abfc3bf02d579a47fda9c7bad5ea1a50a04cb0bc42a1c6d646bdbd828084ba21831f99df213c681c82ee6fcf83729586520f341b522f9adbe59fc26a10c935c44bc239fb5d6a9fb61d32ba8650c25df5135046ec50a830f0e5209089a1db0134d0026a79165bcfe170ad6135fb65487fd7a6745d3f0e4464b8f8786252cbff781076f5f22973c2029c4803e1215e87e4cd7c0cbea38fe6b308990cdf298b1de8e1fea3f3341f535ab75b1939f6552717c4ffb4b2f086fad47685f49d72731f4aebf43750fa792f828f109c5f47b852ff1c84fc088fb8c67050c60c02d29fa386bf31e40576172fe56dd4d22baebd3dff6dd3f584082da631fe8884aa4e469c466a5f1ec3f9832e419aea01ae7957f9750e90e6730046ccd18b09d01ad3b7700cb41dc70708833fe184f3f2e519e3caee016dc86fade3433506e17224ff50fd454e948b6519b4899baa2edff8ccf49dc4edf8f372c48627bad421a8d63922424706b996e62b3b1b384db2b4c70109134f30545da7bed2d4ec7496a4f8234b61a1bdc8e21345d9e3f87e0a273c5b5c73757aafb0b2d000000000000000000000000000000000000000000000000000000000060a12161d22232f",
			exp:     "01 02f91c3a010380018261a894b94f5374fce5edbc8e2a8697c15331677e6ebf0b0a825544c0b90a207d87de68b6a9e476785e8444c253e78b0ca3ef9413dbc673ba62fc47bac1003421ddce3aadb4a1ffaa79d9a91e65d81bf203e5207ced88153c10020512f84c7d78ea6e97e94bdf6bb9e9b750b63fa501355e19fa319ec4024dbbde5dda6d011eed6ce3b14efe488d9b8b3b782231a63e7fdd7b22e433dac65e49ac2e2e3c10a54ce384887a03b98759701fa84cd7ba9d1e1dd90309bc693c5fb8a894c8822b008f3b0f01f560fb011a6e024b6117cbc5eac6de111da5066797afe8145a62766b01e003554e8fc08097a5cb543c51e8c8b1f56b9c38ec7cf9517e6c0e9aee1f504ccad2dce8f801cf9a0b9150d7f6b225d14369f80c1fcee36276f1a0ca108d8ff1687bfaf95266b866c7036430db7900bb50cfe11743180643069df2b278e530ee5f797fd83d8c45fc86eed5d43f6e8c03856f407eb6064dc2d43d45c81c445760584d62c54f201b788aadf5b1ab995e2441413313f7f851ef29baba8f941023c008bbdec58de8b8d60eab199d0ec1e868997ce13d54212e3908fd287f91f6c141fd086d21d5029edbc10d4b52257b25b8a4badb5db366a9284a36788c01f76d95cd34f1d638e90102aa9d0d38a5b555d38e48972d12b099bdcc5daa5262c639e023470306ca8e9d3309e977de9eab71f60d404511335ff158d161e05028e8ea02f834415d95d9951e1d9f06f5b57c25072de43990f06b53ad4df7e9c9279e68326459016f8117aeee35658154607c3c981a76b87c4e75d12d96f877f3b7f47536d1720acb9333db1f76437d8dec247c80528b7ed7e8af92e103c3eb5aa3ba81ce56c23932317a9c8eade68c0342373887f803fc87a667b587dc476aa59086a3045219fe2f7c611a8666215e348177cbe7ca45da8b07ae1842cca020ce7013e83e138efb62eeff88c7e2fb76a1a957d1f02d26d63003c4db6bd4ad6174db1e0502121a899587a0aa049a77a5387569794e414bebeae02295efacfb43b02b94e0268e44c9cfe2f14edfc9058a158aa4dae58b23dd96a915f8942d5b51f81fdc1e45b1985b8f717d84145611f676e3712f5406d7095d8c3d2ebfe17a722d55907e64bba4ee5514fe70071ac03e4f5afaf049a0f24a42cd3a5c68a509a157ac1af2d28864dc66302103c21c52dbd9e6f6f8487d637cd2f3279a2a6fd6b172ef0280768061b0718621dfc0af37f7079fc400e4594d01243c2158fc318dfb5fb9bd3036a4dfa1b52e551a639468b75940028c32accf4d6fef6dc2d9efbe88b4899f9384407bf0cd50d92bed94a14c40d5ae3076ff6284bf214b4b177db663aef6d9ff5ab394bc985f3bdea1e0beace1f5fa0230cf53e57473f50a6610a677a1281d9676001f214bc3cf0987a82424e87e0e7e5237606e60e71f3a92400ac95c0c660015e1b9324aa4b1231c138b35195add8dc4002c26648bc5707c7537623d046281c5597385a87d5bd92060ee6ddc3efa34daf49ffac27cf7a48697f7a1a00ad3cc2d9ee66e67786763ccb086e15cb6d9c868f6072f7d9b6970cadeb1773700c54d2f197e5cc6c6a89d1823fedb207d0b49efc8158f3592efce23046774b03673fb88911af0735c185b94a5f44edee34cc99d1d064808c119bb6a4c90635206b0f440beb519721eadb4df66458655ef3cc4033d7ae8aa0cbf7b7b8f6ae8321a5c26d4964fb01d331ffec57a93a017f0322fea991a93b7e988aea9fd763365b6f4596623ea49692e76bf5dc405de914c14612348076d93bc0a83286974a9a615edfe2da2a7e4f60e15a088b0550afd4aea994d00bc88c20c0cfee38aa57d67736ea2f59698a02ec7174fb5d42e9c6f7520e30b2c386fca2b8fe9ba1e6e79a42a3586670f16ae2138c12ece2e35c74bc0ea4d6199c818f58cb7b4d12419b4af016eb73e60128b70d6092ada8aa8cf2c419208ec39e5cad3ea99f497682d4991b7bc28a2dfb987ef4a72ace24903d7ab72c5c9dfca68179c95165bff6c77558edd55adea46b191763b0b0ee33cfd5ba61a04b425a463230a8297ce46d18e5825c740e8ec1bf56d2cbfa639eb904465f9dc67757eeedc83d61c1684aa67609465a295aead7da61ae97287e7f26e5c541fe932a972c4ab600b4ebd96b55e6a4de291e7d0e8135b9ad1c6283e12d0398f5f2a608a4e56a4955cda77ecc0f8f0fdebad91e65c763bd24f8459e761290974d8ec5ec43974cc89dee08329b8a62d71c411a3d3bd738cd14ac72dceb69d59c33ad974dff0b2cdc6b7cb092c48091c65d4f380288f2a1c3ff643f836447f0e094e12e1d0fed622afce581bb128454efdcfe61dd3767c8d5651ee3cbf79478c467e113866026241b31f5c570abb06ac723bd71d97332cacdd2203951418513f1215fd6fbd4210992087e12558b78fc8a5a921ecff8bacc9ef43f7992be7549207db7261df8a7cd04e18f2cea3e0157a9773cbb6b5d5bfe76ebd6d2141c9ce293e88ea821ef2054a749cf078d1c3b5214b336f883384dd9e4c91113410324051b95d1215de8e552f52e6a3045eec54b725af1a9e884f0ef8ed549e72f54e641e5841d1150eed9bb94be65c3462e02121330acf3f7f0e506f9951fea984fa936eb77e366e4f0e0fc456175c3e81451489cdd8d2f8d7c82ae84cd1805fc8673b1550b736cca2a321b79e185e9b39161b415e670af5f7073dccc4e81387d2eb317aa3a68634191ed4e3791dc0b23a4ac20b0d037224ecd142dd4e69fb2a85911dd9cc6165d4ceef7c24347d1215d4cf4de9ccc04578a6923c589b11604e35abcb553d9a3a62a42e5024a9f6cf1028e5255b957bf1e179812be14100d7cef389a6476ce90a07823f8eef6cde33bf8812bfd89bfc16505150335d715f6c77f50960d529781d965f504da192d6fb503a929641495c2c9d18d8879d33a00640ecfe1611ef0e84d36feb4f0d9276376358046c9edaee456af4ca934c0ca1e95ef657fbf2df2e30c722903e4c76a9c44a6860e6d4c23150a822850c61146e3c2334ba9c793620f95063462dca4028556ce81dec2c24d00b1230b2065100def043b37c2b951a3cb2b32220438f45d1058d396f55a87993ea1b1cc0b4aa9c85ff3182879f3a88c076f455c68e042089b6d35f9b5f99290660cbe249bdf20639282dc7b6d9fc2cccdb0db76134cf0fb932b20a50afe37814a5f76e8be39211603573fbf34be3d8a234bd03a93a8afc41e91b1fc9f51622ea90dbb28dbc64a7f3bdb594f75d9fbc6ea98d50d2df4f2cc28bee17d41174bb0392cab1183c95b747562578eb131042a2d67532fbdc1b0154fc20f7d9337e2ce6f68fb859783f9f27b66af00637b12d37ba40e0afa527b7e61ae878fb131a5452082e72201fadb36f1e24ce5ed087ccbad519a0745185bff4890e5daf135d32d9aa0c340fd7ceed1ada1d47fa8a737de0e47009fbbf717c3c471fe11283b694b687540891da1b9728a5b6deee6481e680521f498d6162093bc03d6ff2ec4f6e80ba086f4909e6a7b9a2c5e59a0d9edabf3056c5b77c87371cde641e6126d588e4aa7929b76b6839e88f97afea1384dadc718b61b314939287ff1f6ec24017a233678b2f64dc65ce08b4b12e6f0f922393ec0d1c7962c5aa881fffe6a95275ec8cd4230f5303fa2ea3f9eefad704777dd2be4f398848622d21c8b6c3ba5050b3768e5bdfb911f3f34431a005b02801b954002b546f770217a02f7e911afcd81379368486c592e6857503dae235aef60177f88b2c603fd7cec9b2c7fc08612486e31d4777de6c5a0e9e0958019e88b46314b875a9cbfa18e33416fb0783e3d6e6ce02260db0d4215a92039b6eccd508cd5f32c76822a084b9bd1f708209f09c12761093ee9cc94675d78bc06ba1e61227d4cb5c0cd9caffdd9d1198485ef27311873173fa36db31a36e2d4cdd17021aee99c7200df53ebf168e11dcbfe9e58cf67836b37eed18e1580225d2f5dc6eb085f4e9cad4b8558f3981ad4f8de122d2f049cc8c50f2523e339bb7a4e80a11836fec6bb54686eb75456b194c2a1025486b4682c0753f32c9d01fa5e80e50aed572f11a20078dec9dc6f379d017eedd48921e892981e32d447e107cd5d9fa673a86f3488a393d910ceeccfb2cdd72079f2ead0250a54ce0c4270654e2202f63c314a9fd3ffa345348449ea2bab101b59d1bbe671a5d8278abf1a6f8fe5a447fa3bc79c7b666a7cb886cfeefc20d200e4dc2c2485ec85d185de33d816e182bb549041547b4e13373f8f9e797a4adc5f62d8446a641724e0977cae482320a72b2fdb2bcb36a0224afdaf779991e132349080461a3f1d1b03b3d1557709ad2c75edc707fc368ac8515e772c72e82ff5bfdfb585b9ee2ac06d3bdeb7e89bcaf299e2c80f5ad9248931f8971e5d9379634cf1a4141d193a403c6c3c52dab5b3a950d3144e4f02028730fc9083ef988fcaa903d5528c8a6a29eb3c8a34931521f95604e0a8c381a179bafecadf80876cfbe071bbcba1df675db4a90873a7f613be1a1b0cac58bc345f9da09b6c438903e34e9170202e40239577f3ca3a1a17b7849c10eb789a20266e44799fd0c6da8cc26ab6e03d881c5055358cfb9c94d6639b7e089ed34f7cf8b3bf2b3aa08d7fe4e5a6468cf22a446d11fb22d8fc3bb104d5138c9150d87c142f8a4432ccd5fa5b023cc174e4eccf876ad5a02d1276ccd3e600d5d69d6d6c324e45ba1e0ad7e0b4fffba85160e7de52fc0a509ac15f5ca1d78585249d570a4986adbdbc1d873b529a465d7df675419d823abf06bb7cac4549a9db0e7e365b4026ed1ef6b6d3d8c98daacd8091b8e74c8366e6628c885418a52e9b5d40c8100605c3b279ca20dd7298dead7f14f03b0e9d25cc2543bf5fc46a1825a1a1714a2a2e4e94507997e923b13e036ffbcffd41741d3ee2604586fe29593899fe73ee57e18706f835c4b7f4845ef759b767c88c272075a4080416d5292727477339ea5ce5a152cd66773e43701f94e0d2cfbe9e42a32aea4bfe2624c90cd9dafe9ac42e1fe7499b1bec1fefc05ac231cb3f3dfee7785924a6e99924b6e79257ebccc9fa2ffd8dcf4c29f829f2909facb38a3f85a8de8c866285d2a030c2bf50f86518c5548f980314ee90fac69fd9eab18fc1228bceb7f996b1a4e3584b7508afddf85bc8129293f853b2805dfdc81b4808381a84b80bc9b481722b90857ea2cd45f1845463e422855706925c1b6180f23d9df4cc6b15f95cc18871e7c6c1a65ba836ebf69ba38c0dcbd7b5267a3243739246de49934ef6738acb4d77018b8bef64aec9bdb3937442860dd89e68ae331522dadcb507ff5a02de1eb383cf47f3d4bbf32f83f369b2c8b9f9246bf3749cdc95e268f9e88ab49da37095bfe6a655feee1940a532d73817ed8f65d696edb6a0c5b0cc5755470dfa57296eea083e0b16bee0a21d5dc22e7ce8956c1c09dded654340e42fc9ae05c6f13df808df31715892562895bc238a3cea27700ab93a39072c778c7b280aab72b52b684acdb50ca2aa30845ae5c231599b80d7bb8a93422a3a6423f174cfaf9fea4f0c2dc91b8cadf4e7e335452f32715c88925ec98a24ba3027aeefa9c67d32f0ed75c8ec27197df2cea9eb437796614bd21410a778ecaedf7e9727b1cbf4741bdfbd74aaa41162c760da6d1603fab8f13d23fc936c732b01eb7771057ff144ac84b8f3b7b52047561d41cec8e7d2b232d8966c8410ddaf703c6b86479e3de8a9300f8ff4dc69dc4f88cd54807d22046f3ffe6398398d4c46c0bf8062ecde57d774c05bcdbf862b11aaa836db73fab0e12dfd9e151db61775c9fbf45f798108d39d280364b542f1dac236522f87c9df0d08783edb85187340b1ddcbfda183776929cface8589d55b9534e6f87e128def94a58515042b753275518ab3e63d305aea4f38b020d816dd867e91816f04af4e50a42604ee87d1084a6f6e9a368cb75d8be0db592fc686cc619afa012dcfcd0ebf5a2665e0ee428caebb4ec81c7285998be9fae1c0addae6f6d9322606e052e7c517472291ce63561e94b955899b2cb168d1a74e71a26fce5c05ed0d6f59d40a908a76e99352ad20ce3b82c0896814f6c7fa1b22dc766458d569925b3d0f17513d4458175b738d2f31f437fc30cba8f9c4e60d9e8c8aa74a569350276c6eb33785bb516490609d80b63126a8067ccbcff8a94f154ba9ee15d53f4f1a05e0dcd05ae2c5258464d5ba09f74245410112c781741745ad0d0662e7b6774fc0f20471645a1ac1e3bd3b16f06c7e02e779071d955b1f691877fd37d6af1e023d94383c621f6b7531a4742ac856181237b4bdf07811ea670e29b3b0e69a447651b9337d0bcf4b407b0d7bdd74afb2cb47cacb78574e46a5a12af625fe9c7ca119d596d7742dbba8df1b59836c867611e942df5565ad8aa07d56b8905de818ebddc9454154db4ec29602a5af41e61149bdccafb682b2afbd0ccb2ac7e941fff0c445cbdef5f9ec1cfb7cfab93d1a7da5ec66d321e5e3f97d2e30aabc5d520f27ca33bbdde1e8501ac2f0a714dab49189ea29f44b8def7cf3f46c8ab8bb557a9169639da9e7f2bead11d6e733b1e4f34454daf6dcdfd3151183c6f7e44882f7359807a6c79491b3be5e6a50d0e7f80d5a7e3b1c74d908203c5448bb4cbd22a79e20509a23a5ebc7d7e8d08c24659cbb21b01e5e476852dc3c237d1ba15d20986146e55a207656bca90eeaa9439fe648ef3abc13fd756880f7092f68e5933401efe5f76766722b8dbfe432e33587f29126d53723dd7aa17510784ebd1329ad312442a9fb891d523279a69fa9a69e6a6ea3b4b568a2683de827aebfea62250616fe36ad1b856b1d93454f444ba63bb2c35ae54d859bb34934a70e3d9ce30204f75fcf6ae53f6af2cf272c8ac894f874754609988bde2197f0f2f76c8593103dfdc1b9e0675aa342bcd10128a868f8a73a312a71805c0e72792827a85bebfa30f18ba24080aa0c3c4ea863758b9cbc8f61faa255e07559311b70e996fe2b555d2e71b754fae720f050c73efcd6078d142e574a16349cf77fa59334391215107f779ad0be52cc441cd5dc366249cd4ed9aeff64db520fe0aea0811963b17e42d42e6e3b600a8bff2aed2ff4a1e7b53fe1212ddc5369bd73b714c279a9d906b7821e7e5ad5ea9589562852cfaf9fe2ace553bb1489b799824a0b18336170fac7795a4ed2d285679749055ab992f7217d2622f6d07a74190e906c24c7b3f6c4dfe73b97c0f47cc272880b2fca5bd45183c85f93be1d9afcdc3145c714065e5b9efa5c1b4bda2900a720fcc4970bce297fa040f25dc413f60819eac855dc7714eb545e001c326f06e8f05b64f1e1f498a37ec69f8c92710edd05dec1f8d9b68dd8d0eff460e18de762bc397738f736442f3777e45e8937f4358cd9104e2d505cad9be44fe275ff37d42f93b4516ce8d8ccaf37feeaef3636c9f990ffcf7dacaa9a6ad94dd2d294de3a531848c11e70b39cb6e9581996861259749c0c12f20fdfafd9e3ba8a13465272dcd68c069a7c74407dbbbc2e190708f433cb51f7761ed9bd085991a2a634bb2d88ae12321e5bf730532e23fae44176cb13b82a06c39a0bf4148c3496cbca12609ec842a6e1c7ab521dc273e3b1768bd8e56a3babf055334da926f6438ccc8c382eb2331f5dd99b6921313f16e6afcc3a88da1a61535030ad64815ad179f64d5c764e148dc674f671a7dce09cc40ae6d2eec2d308bea65c8329b2bdd0cbb0c442153266eabe10c1238efba7c7996234eeb050ad47e10ad26be1d356a491a023e80df634f9279d450109b9dcc69740a55d5be2cd6c20ad9bd8967d62255cf44ac59add5ba54818d6e4d5cde5aa03de4b867a10d35e6d365d0931bfdd0592dc17ac64a80da4b67bb5387cc4d9fadaa1394b2a46eaa07f2aba2b6209de3eec706290c27f102a772375505469fd59162ce58bbcf87ac64d33a803939525bf11c5170d90286bc0e0114827d13246d9ed69e16d9616af22e8451c3522ad524801454d5c25f3abcbc1a3e2055e6959136c6b01ee775fa6917ae1a674bc4129a973d5e347f2df66031414e3e40cef7c02432b7ea9c758fb2dc88647cef4eb093ddc8a359180412c16f6ca4726e3cde3262c4019df888b430ce7728fe508e083bcb6f3384fb4609b56c0c18b431a06a1a6072dbd7a86d72af95235ee4f71cfb8ffac52a0c3b0af0a233eaf2005dee1aa685c10729cb500a459eec491bf76b36767f913d053d0867ba3f0f5801f6c0084ffc2d29f9086796e31c88c94ffc7a9230397bdaca1df3d80dd45c12259495b1fcf7e0f8eeef72d716285487ca89eb048dba9217389041258acf4b55162d2c4abd617347a5cd8c64b014d0f383e2ba012599e3cb1cb1691ac5b828e9f5ad41f9cfb3ee19c80759d501f64171c4352f8b20c3b7cb7d6324e661c4744bfeaf557eedc90df09794d92a6a7e14eeb68380c3df5aa701e0bf94f39af6eb9633709a55eb971bb8929233d6ab9e988ce6ca2b590562d4186861e6212ef51717a6271b5940a452cf2954abcc08ef3b41ef60e4d96d160b1f4d72ee332c8271ca497e2cdb2e7b0412c7b9b64892b47a40f42a22e41eabbd6d3b6af43cd44f8fc03739c2bd0ad7fcb6a944fe7020d40d8b83bf261d05f30ce0a6ef5489de89b76a071ebebcbda578c8bfa30082d8f0ab9d93cd5866a3b52024e5eae194697620838f9f4b4fa2889bf21095097008b661cc9c9eba1761c6ae98fc99a429afae9ec3a2c56631cebc6fa3d92c5b5fa7cf5a008cff849ded723adb0a8a2be019dffebd73b8aaab4f4e0e1eac01ce5c284cec7afa720175b42fbbc819561672890f636203b104fbc40f8f6467ad6f268e99cd51600ad0cfaa7b54d6ff86bf049443e619968209a63576d0953c810669d7c89cbcb0927eab931529e84403e1faff58f6ace6d4e11c7b892290760009e950d94e6d68fa38180009fb92bab34c88e931023885400d9efa67e85d7111905eb5cf9232bb860816085054e62e13e85a5e627116fa550c005ce14e585ca27807cd70b78e7eae4520ee4fa7218d335dc44ed9cebf68c2571e239391b76ea6286b303e2045a1803679b268a2214546aa336c25dcc75a866f11d16eef7f0b378815aff07835a60a916d6c1e0e3ddb512251d4c116f5ca7e53c23a65496e47a62e4f313a228a0c2bf9362f655d3b055dad7a7bdec6cb0d4bacd81c7fd7b15189beb668f3d91e7920e22589eb6549c23e69baac979159ae6bea9164edae4cc77aefbdb0fd08b2faebca0662be878de5dbb9b4ff740acad09d78d5cd38a3bb895d12dbe6535fde2a736b6a35f7acbf7dfad9e79bfe7287c1836c594f8bc52672a6916185f4059773580c679ecd6d6c5ad0c4aac09c8d402395ce31e3647f91e98dc898efb59e1b9d5726e2621930c1d4443e7e7985cef9aaccdd58474d248ea465bdd093c590ebaf727437879051d1c357a63f01b66fb607607cfc6fb32cc22ad7be845df3646a46c03cac7e3c4cd750f04ff5320688db246f2487ad553b3112207d2b22ef1a41929bbd1e3202488b16f0832b06b891cb3abfc3bf02d579a47fda9c7bad5ea1a50a04cb0bc42a1c6d646bdbd828084ba21831f99df213c681c82ee6fcf83729586520f341b522f9adbe59fc26a10c935c44bc239fb5d6a9fb61d32ba8650c25df5135046ec50a830f0e5209089a1db0134d0026a79165bcfe170ad6135fb65487fd7a6745d3f0e4464b8f8786252cbff781076f5f22973c2029c4803e1215e87e4cd7c0cbea38fe6b308990cdf298b1de8e1fea3f3341f535ab75b1939f6552717c4ffb4b2f086fad47685f49d72731f4aebf43750fa792f828f109c5f47b852ff1c84fc088fb8c67050c60c02d29fa386bf31e40576172fe56dd4d22baebd3dff6dd3f584082da631fe8884aa4e469c466a5f1ec3f9832e419aea01ae7957f9750e90e6730046ccd18b09d01ad3b7700cb41dc70708833fe184f3f2e519e3caee016dc86fade3433506e17224ff50fd454e948b6519b4899baa2edff8ccf49dc4edf8f372c48627bad421a8d63922424706b996e62b3b1b384db2b4c70109134f30545da7bed2d4ec7496a4f8234b61a1bdc8e21345d9e3f87e0a273c5b5c73757aafb0b2d000000000000000000000000000000000000000000000000000000000060a12161d22232f\n80 02f91c3a010380018261a894b94f5374fce5edbc8e2a8697c15331677e6ebf0b0a825544c0b90a207d87de68b6a9e476785e8444c253e78b0ca3ef9413dbc673ba62fc47bac1003421ddce3aadb4a1ffaa79d9a91e65d81bf203e5207ced88153c10020512f84c7d78ea6e97e94bdf6bb9e9b750b63fa501355e19fa319ec4024dbbde5dda6d011eed6ce3b14efe488d9b8b3b782231a63e7fdd7b22e433dac65e49ac2e2e3c10a54ce384887a03b98759701fa84cd7ba9d1e1dd90309bc693c5fb8a894c8822b008f3b0f01f560fb011a6e024b6117cbc5eac6de111da5066797afe8145a62766b01e003554e8fc08097a5cb543c51e8c8b1f56b9c38ec7cf9517e6c0e9aee1f504ccad2dce8f801cf9a0b9150d7f6b225d14369f80c1fcee36276f1a0ca108d8ff1687bfaf95266b866c7036430db7900bb50cfe11743180643069df2b278e530ee5f797fd83d8c45fc86eed5d43f6e8c03856f407eb6064dc2d43d45c81c445760584d62c54f201b788aadf5b1ab995e2441413313f7f851ef29baba8f941023c008bbdec58de8b8d60eab199d0ec1e868997ce13d54212e3908fd287f91f6c141fd086d21d5029edbc10d4b52257b25b8a4badb5db366a9284a36788c01f76d95cd34f1d638e90102aa9d0d38a5b555d38e48972d12b099bdcc5daa5262c639e023470306ca8e9d3309e977de9eab71f60d404511335ff158d161e05028e8ea02f834415d95d9951e1d9f06f5b57c25072de43990f06b53ad4df7e9c9279e68326459016f8117aeee35658154607c3c981a76b87c4e75d12d96f877f3b7f47536d1720acb9333db1f76437d8dec247c80528b7ed7e8af92e103c3eb5aa3ba81ce56c23932317a9c8eade68c0342373887f803fc87a667b587dc476aa59086a3045219fe2f7c611a8666215e348177cbe7ca45da8b07ae1842cca020ce7013e83e138efb62eeff88c7e2fb76a1a957d1f02d26d63003c4db6bd4ad6174db1e0502121a899587a0aa049a77a5387569794e414bebeae02295efacfb43b02b94e0268e44c9cfe2f14edfc9058a158aa4dae58b23dd96a915f8942d5b51f81fdc1e45b1985b8f717d84145611f676e3712f5406d7095d8c3d2ebfe17a722d55907e64bba4ee5514fe70071ac03e4f5afaf049a0f24a42cd3a5c68a509a157ac1af2d28864dc66302103c21c52dbd9e6f6f8487d637cd2f3279a2a6fd6b172ef0280768061b0718621dfc0af37f7079fc400e4594d01243c2158fc318dfb5fb9bd3036a4dfa1b52e551a639468b75940028c32accf4d6fef6dc2d9efbe88b4899f9384407bf0cd50d92bed94a14c40d5ae3076ff6284bf214b4b177db663aef6d9ff5ab394bc985f3bdea1e0beace1f5fa0230cf53e57473f50a6610a677a1281d9676001f214bc3cf0987a82424e87e0e7e5237606e60e71f3a92400ac95c0c660015e1b9324aa4b1231c138b35195add8dc4002c26648bc5707c7537623d046281c5597385a87d5bd92060ee6ddc3efa34daf49ffac27cf7a48697f7a1a00ad3cc2d9ee66e67786763ccb086e15cb6d9c868f6072f7d9b6970cadeb1773700c54d2f197e5cc6c6a89d1823fedb207d0b49efc8158f3592efce23046774b03673fb88911af0735c185b94a5f44edee34cc99d1d064808c119bb6a4c90635206b0f440beb519721eadb4df66458655ef3cc4033d7ae8aa0cbf7b7b8f6ae8321a5c26d4964fb01d331ffec57a93a017f0322fea991a93b7e988aea9fd763365b6f4596623ea49692e76bf5dc405de914c14612348076d93bc0a83286974a9a615edfe2da2a7e4f60e15a088b0550afd4aea994d00bc88c20c0cfee38aa57d67736ea2f59698a02ec7174fb5d42e9c6f7520e30b2c386fca2b8fe9ba1e6e79a42a3586670f16ae2138c12ece2e35c74bc0ea4d6199c818f58cb7b4d12419b4af016eb73e60128b70d6092ada8aa8cf2c419208ec39e5cad3ea99f497682d4991b7bc28a2dfb987ef4a72ace24903d7ab72c5c9dfca68179c95165bff6c77558edd55adea46b191763b0b0ee33cfd5ba61a04b425a463230a8297ce46d18e5825c740e8ec1bf56d2cbfa639eb904465f9dc67757eeedc83d61c1684aa67609465a295aead7da61ae97287e7f26e5c541fe932a972c4ab600b4ebd96b55e6a4de291e7d0e8135b9ad1c6283e12d0398f5f2a608a4e56a4955cda77ecc0f8f0fdebad91e65c763bd24f8459e761290974d8ec5ec43974cc89dee08329b8a62d71c411a3d3bd738cd14ac72dceb69d59c33ad974dff0b2cdc6b7cb092c48091c65d4f380288f2a1c3ff643f836447f0e094e12e1d0fed622afce581bb128454efdcfe61dd3767c8d5651ee3cbf79478c467e113866026241b31f5c570abb06ac723bd71d97332cacdd2203951418513f1215fd6fbd4210992087e12558b78fc8a5a921ecff8bacc9ef43f7992be7549207db7261df8a7cd04e18f2cea3e0157a9773cbb6b5d5bfe76ebd6d2141c9ce293e88ea821ef2054a749cf078d1c3b5214b336f883384dd9e4c91113410324051b95d1215de8e552f52e6a3045eec54b725af1a9e884f0ef8ed549e72f54e641e5841d1150eed9bb94be65c3462e02121330acf3f7f0e506f9951fea984fa936eb77e366e4f0e0fc456175c3e81451489cdd8d2f8d7c82ae84cd1805fc8673b1550b736cca2a321b79e185e9b39161b415e670af5f7073dccc4e81387d2eb317aa3a68634191ed4e3791dc0b23a4ac20b0d037224ecd142dd4e69fb2a85911dd9cc6165d4ceef7c24347d1215d4cf4de9ccc04578a6923c589b11604e35abcb553d9a3a62a42e5024a9f6cf1028e5255b957bf1e179812be14100d7cef389a6476ce90a07823f8eef6cde33bf8812bfd89bfc16505150335d715f6c77f50960d529781d965f504da192d6fb503a929641495c2c9d18d8879d33a00640ecfe1611ef0e84d36feb4f0d9276376358046c9edaee456af4ca934c0ca1e95ef657fbf2df2e30c722903e4c76a9c44a6860e6d4c23150a822850c61146e3c2334ba9c793620f95063462dca4028556ce81dec2c24d00b1230b2065100def043b37c2b951a3cb2b32220438f45d1058d396f55a87993ea1b1cc0b4aa9c85ff3182879f3a88c076f455c68e042089b6d35f9b5f99290660cbe249bdf20639282dc7b6d9fc2cccdb0db76134cf0fb932b20a50afe37814a5f76e8be39211603573fbf34be3d8a234bd03a93a8afc41e91b1fc9f51622ea90dbb28dbc64a7f3bdb594f75d9fbc6ea98d50d2df4f2cc28bee17d41174bb0392cab1183c95b747562578eb131042a2d67532fbdc1b0154fc20f7d9337e2ce6f68fb859783f9f27b66af00637b12d37ba40e0afa527b7e61ae878fb131a5452082e72201fadb36f1e24ce5ed087ccbad519a0745185bff4890e5daf135d32d9aa0c340fd7ceed1ada1d47fa8a737de0e47009fbbf717c3c471fe11283b694b687540891da1b9728a5b6deee6481e680521f498d6162093bc03d6ff2ec4f6e80ba086f4909e6a7b9a2c5e59a0d9edabf3056c5b77c87371cde641e6126d588e4aa7929b76b6839e88f97afea1384dadc718b61b314939287ff1f6ec24017a233678b2f64dc65ce08b4b12e6f0f922393ec0d1c7962c5aa881fffe6a95275ec8cd4230f5303fa2ea3f9eefad704777dd2be4f398848622d21c8b6c3ba5050b3768e5bdfb911f3f34431a005b02801b954002b546f770217a02f7e911afcd81379368486c592e6857503dae235aef60177f88b2c603fd7cec9b2c7fc08612486e31d4777de6c5a0e9e0958019e88b46314b875a9cbfa18e33416fb0783e3d6e6ce02260db0d4215a92039b6eccd508cd5f32c76822a084b9bd1f708209f09c12761093ee9cc94675d78bc06ba1e61227d4cb5c0cd9caffdd9d1198485ef27311873173fa36db31a36e2d4cdd17021aee99c7200df53ebf168e11dcbfe9e58cf67836b37eed18e1580225d2f5dc6eb085f4e9cad4b8558f3981ad4f8de122d2f049cc8c50f2523e339bb7a4e80a11836fec6bb54686eb75456b194c2a1025486b4682c0753f32c9d01fa5e80e50aed572f11a20078dec9dc6f379d017eedd48921e892981e32d447e107cd5d9fa673a86f3488a393d910ceeccfb2cdd72079f2ead0250a54ce0c4270654e2202f63c314a9fd3ffa345348449ea2bab101b59d1bbe671a5d8278abf1a6f8fe5a447fa3bc79c7b666a7cb886cfeefc20d200e4dc2c2485ec85d185de33d816e182bb549041547b4e13373f8f9e797a4adc5f62d8446a641724e0977cae482320a72b2fdb2bcb36a0224afdaf779991e132349080461a3f1d1b03b3d1557709ad2c75edc707fc368ac8515e772c72e82ff5bfdfb585b9ee2ac06d3bdeb7e89bcaf299e2c80f5ad9248931f8971e5d9379634cf1a4141d193a403c6c3c52dab5b3a950d3144e4f02028730fc9083ef988fcaa903d5528c8a6a29eb3c8a34931521f95604e0a8c381a179bafecadf80876cfbe071bbcba1df675db4a90873a7f613be1a1b0cac58bc345f9da09b6c438903e34e9170202e40239577f3ca3a1a17b7849c10eb789a20266e44799fd0c6da8cc26ab6e03d881c5055358cfb9c94d6639b7e089ed34f7cf8b3bf2b3aa08d7fe4e5a6468cf22a446d11fb22d8fc3bb104d5138c9150d87c142f8a4432ccd5fa5b023cc174e4eccf876ad5a02d1276ccd3e600d5d69d6d6c324e45ba1e0ad7e0b4fffba85160e7de52fc0a509ac15f5ca1d78585249d570a4986adbdbc1d873b529a465d7df675419d823abf06bb7cac4549a9db0e7e365b4026ed1ef6b6d3d8c98daacd8091b8e74c8366e6628c885418a52e9b5d40c8100605c3b279ca20dd7298dead7f14f03b0e9d25cc2543bf5fc46a1825a1a1714a2a2e4e94507997e923b13e036ffbcffd41741d3ee2604586fe29593899fe73ee57e18706f835c4b7f4845ef759b767c88c272075a4080416d5292727477339ea5ce5a152cd66773e43701f94e0d2cfbe9e42a32aea4bfe2624c90cd9dafe9ac42e1fe7499b1bec1fefc05ac231cb3f3dfee7785924a6e99924b6e79257ebccc9fa2ffd8dcf4c29f829f2909facb38a3f85a8de8c866285d2a030c2bf50f86518c5548f980314ee90fac69fd9eab18fc1228bceb7f996b1a4e3584b7508afddf85bc8129293f853b2805dfdc81b4808381a84b80bc9b481722b90857ea2cd45f1845463e422855706925c1b6180f23d9df4cc6b15f95cc18871e7c6c1a65ba836ebf69ba38c0dcbd7b5267a3243739246de49934ef6738acb4d77018b8bef64aec9bdb3937442860dd89e68ae331522dadcb507ff5a02de1eb383cf47f3d4bbf32f83f369b2c8b9f9246bf3749cdc95e268f9e88ab49da37095bfe6a655feee1940a532d73817ed8f65d696edb6a0c5b0cc5755470dfa57296eea083e0b16bee0a21d5dc22e7ce8956c1c09dded654340e42fc9ae05c6f13df808df31715892562895bc238a3cea27700ab93a39072c778c7b280aab72b52b684acdb50ca2aa30845ae5c231599b80d7bb8a93422a3a6423f174cfaf9fea4f0c2dc91b8cadf4e7e335452f32715c88925ec98a24ba3027aeefa9c67d32f0ed75c8ec27197df2cea9eb437796614bd21410a778ecaedf7e9727b1cbf4741bdfbd74aaa41162c760da6d1603fab8f13d23fc936c732b01eb7771057ff144ac84b8f3b7b52047561d41cec8e7d2b232d8966c8410ddaf703c6b86479e3de8a9300f8ff4dc69dc4f88cd54807d22046f3ffe6398398d4c46c0bf8062ecde57d774c05bcdbf862b11aaa836db73fab0e12dfd9e151db61775c9fbf45f798108d39d280364b542f1dac236522f87c9df0d08783edb85187340b1ddcbfda183776929cface8589d55b9534e6f87e128def94a58515042b753275518ab3e63d305aea4f38b020d816dd867e91816f04af4e50a42604ee87d1084a6f6e9a368cb75d8be0db592fc686cc619afa012dcfcd0ebf5a2665e0ee428caebb4ec81c7285998be9fae1c0addae6f6d9322606e052e7c517472291ce63561e94b955899b2cb168d1a74e71a26fce5c05ed0d6f59d40a908a76e99352ad20ce3b82c0896814f6c7fa1b22dc766458d569925b3d0f17513d4458175b738d2f31f437fc30cba8f9c4e60d9e8c8aa74a569350276c6eb33785bb516490609d80b63126a8067ccbcff8a94f154ba9ee15d53f4f1a05e0dcd05ae2c5258464d5ba09f74245410112c781741745ad0d0662e7b6774fc0f20471645a1ac1e3bd3b16f06c7e02e779071d955b1f691877fd37d6af1e023d94383c621f6b7531a4742ac856181237b4bdf07811ea670e29b3b0e69a447651b9337d0bcf4b407b0d7bdd74afb2cb47cacb78574e46a5a12af625fe9c7ca119d596d7742dbba8df1b59836c867611e942df5565ad8aa07d56b8905de818ebddc9454154db4ec29602a5af41e61149bdccafb682b2afbd0ccb2ac7e941fff0c445cbdef5f9ec1cfb7cfab93d1a7da5ec66d321e5e3f97d2e30aabc5d520f27ca33bbdde1e8501ac2f0a714dab49189ea29f44b8def7cf3f46c8ab8bb557a9169639da9e7f2bead11d6e733b1e4f34454daf6dcdfd3151183c6f7e44882f7359807a6c79491b3be5e6a50d0e7f80d5a7e3b1c74d908203c5448bb4cbd22a79e20509a23a5ebc7d7e8d08c24659cbb21b01e5e476852dc3c237d1ba15d20986146e55a207656bca90eeaa9439fe648ef3abc13fd756880f7092f68e5933401efe5f76766722b8dbfe432e33587f29126d53723dd7aa17510784ebd1329ad312442a9fb891d523279a69fa9a69e6a6ea3b4b568a2683de827aebfea62250616fe36ad1b856b1d93454f444ba63bb2c35ae54d859bb34934a70e3d9ce30204f75fcf6ae53f6af2cf272c8ac894f874754609988bde2197f0f2f76c8593103dfdc1b9e0675aa342bcd10128a868f8a73a312a71805c0e72792827a85bebfa30f18ba24080aa0c3c4ea863758b9cbc8f61faa255e07559311b70e996fe2b555d2e71b754fae720f050c73efcd6078d142e574a16349cf77fa59334391215107f779ad0be52cc441cd5dc366249cd4ed9aeff64db520fe0aea0811963b17e42d42e6e3b600a8bff2aed2ff4a1e7b53fe1212ddc5369bd73b714c279a9d906b7821e7e5ad5ea9589562852cfaf9fe2ace553bb1489b799824a0b18336170fac7795a4ed2d285679749055ab992f7217d2622f6d07a74190e906c24c7b3f6c4dfe73b97c0f47cc272880b2fca5bd45183c85f93be1d9afcdc3145c714065e5b9efa5c1b4bda2900a720fcc4970bce297fa040f25dc413f60819eac855dc7714eb545e001c326f06e8f05b64f1e1f498a37ec69f8c92710edd05dec1f8d9b68dd8d0eff460e18de762bc397738f736442f3777e45e8937f4358cd9104e2d505cad9be44fe275ff37d42f93b4516ce8d8ccaf37feeaef3636c9f990ffcf7dacaa9a6ad94dd2d294de3a531848c11e70b39cb6e9581996861259749c0c12f20fdfafd9e3ba8a13465272dcd68c069a7c74407dbbbc2e190708f433cb51f7761ed9bd085991a2a634bb2d88ae12321e5bf730532e23fae44176cb13b82a06c39a0bf4148c3496cbca12609ec842a6e1c7ab521dc273e3b1768bd8e56a3babf055334da926f6438ccc8c382eb2331f5dd99b6921313f16e6afcc3a88da1a61535030ad64815ad179f64d5c764e148dc674f671a7dce09cc40ae6d2eec2d308bea65c8329b2bdd0cbb0c442153266eabe10c1238efba7c7996234eeb050ad47e10ad26be1d356a491a023e80df634f9279d450109b9dcc69740a55d5be2cd6c20ad9bd8967d62255cf44ac59add5ba54818d6e4d5cde5aa03de4b867a10d35e6d365d0931bfdd0592dc17ac64a80da4b67bb5387cc4d9fadaa1394b2a46eaa07f2aba2b6209de3eec706290c27f102a772375505469fd59162ce58bbcf87ac64d33a803939525bf11c5170d90286bc0e0114827d13246d9ed69e16d9616af22e8451c3522ad524801454d5c25f3abcbc1a3e2055e6959136c6b01ee775fa6917ae1a674bc4129a973d5e347f2df66031414e3e40cef7c02432b7ea9c758fb2dc88647cef4eb093ddc8a359180412c16f6ca4726e3cde3262c4019df888b430ce7728fe508e083bcb6f3384fb4609b56c0c18b431a06a1a6072dbd7a86d72af95235ee4f71cfb8ffac52a0c3b0af0a233eaf2005dee1aa685c10729cb500a459eec491bf76b36767f913d053d0867ba3f0f5801f6c0084ffc2d29f9086796e31c88c94ffc7a9230397bdaca1df3d80dd45c12259495b1fcf7e0f8eeef72d716285487ca89eb048dba9217389041258acf4b55162d2c4abd617347a5cd8c64b014d0f383e2ba012599e3cb1cb1691ac5b828e9f5ad41f9cfb3ee19c80759d501f64171c4352f8b20c3b7cb7d6324e661c4744bfeaf557eedc90df09794d92a6a7e14eeb68380c3df5aa701e0bf94f39af6eb9633709a55eb971bb8929233d6ab9e988ce6ca2b590562d4186861e6212ef51717a6271b5940a452cf2954abcc08ef3b41ef60e4d96d160b1f4d72ee332c8271ca497e2cdb2e7b0412c7b9b64892b47a40f42a22e41eabbd6d3b6af43cd44f8fc03739c2bd0ad7fcb6a944fe7020d40d8b83bf261d05f30ce0a6ef5489de89b76a071ebebcbda578c8bfa30082d8f0ab9d93cd5866a3b52024e5eae194697620838f9f4b4fa2889bf21095097008b661cc9c9eba1761c6ae98fc99a429afae9ec3a2c56631cebc6fa3d92c5b5fa7cf5a008cff849ded723adb0a8a2be019dffebd73b8aaab4f4e0e1eac01ce5c284cec7afa720175b42fbbc819561672890f636203b104fbc40f8f6467ad6f268e99cd51600ad0cfaa7b54d6ff86bf049443e619968209a63576d0953c810669d7c89cbcb0927eab931529e84403e1faff58f6ace6d4e11c7b892290760009e950d94e6d68fa38180009fb92bab34c88e931023885400d9efa67e85d7111905eb5cf9232bb860816085054e62e13e85a5e627116fa550c005ce14e585ca27807cd70b78e7eae4520ee4fa7218d335dc44ed9cebf68c2571e239391b76ea6286b303e2045a1803679b268a2214546aa336c25dcc75a866f11d16eef7f0b378815aff07835a60a916d6c1e0e3ddb512251d4c116f5ca7e53c23a65496e47a62e4f313a228a0c2bf9362f655d3b055dad7a7bdec6cb0d4bacd81c7fd7b15189beb668f3d91e7920e22589eb6549c23e69baac979159ae6bea9164edae4cc77aefbdb0fd08b2faebca0662be878de5dbb9b4ff740acad09d78d5cd38a3bb895d12dbe6535fde2a736b6a35f7acbf7dfad9e79bfe7287c1836c594f8bc52672a6916185f4059773580c679ecd6d6c5ad0c4aac09c8d402395ce31e3647f91e98dc898efb59e1b9d5726e2621930c1d4443e7e7985cef9aaccdd58474d248ea465bdd093c590ebaf727437879051d1c357a63f01b66fb607607cfc6fb32cc22ad7be845df3646a46c03cac7e3c4cd750f04ff5320688db246f2487ad553b3112207d2b22ef1a41929bbd1e3202488b16f0832b06b891cb3abfc3bf02d579a47fda9c7bad5ea1a50a04cb0bc42a1c6d646bdbd828084ba21831f99df213c681c82ee6fcf83729586520f341b522f9adbe59fc26a10c935c44bc239fb5d6a9fb61d32ba8650c25df5135046ec50a830f0e5209089a1db0134d0026a79165bcfe170ad6135fb65487fd7a6745d3f0e4464b8f8786252cbff781076f5f22973c2029c4803e1215e87e4cd7c0cbea38fe6b308990cdf298b1de8e1fea3f3341f535ab75b1939f6552717c4ffb4b2f086fad47685f49d72731f4aebf43750fa792f828f109c5f47b852ff1c84fc088fb8c67050c60c02d29fa386bf31e40576172fe56dd4d22baebd3dff6dd3f584082da631fe8884aa4e469c466a5f1ec3f9832e419aea01ae7957f9750e90e6730046ccd18b09d01ad3b7700cb41dc70708833fe184f3f2e519e3caee016dc86fade3433506e17224ff50fd454e948b6519b4899baa2edff8ccf49dc4edf8f372c48627bad421a8d63922424706b996e62b3b1b384db2b4c70109134f30545da7bed2d4ec7496a4f8234b61a1bdc8e21345d9e3f87e0a273c5b5c73757aafb0b2d000000000000000000000000000000000000000000000000000000000060a12161d22232f\n",
		},
	} {
		d := &hashToHumanReadable{}
		var t1, t2 types.Transaction
		rlp.DecodeBytes(common.FromHex(tc.rlpData), &t1)
		rlp.DecodeBytes(common.FromHex(tc.rlpData), &t2)
		txs := types.Transactions{&t1, &t2}
		types.DeriveSha(txs, d)
		if tc.exp != string(d.data) {
			t.Fatalf("Want\n%v\nhave:\n%v", tc.exp, string(d.data))
		}
	}
}

func BenchmarkDeriveSha200(b *testing.B) {
	txs, err := genTxs(200)
	if err != nil {
		b.Fatal(err)
	}
	var exp common.Hash
	var got common.Hash
	b.Run("std_trie", func(b *testing.B) {
		b.ResetTimer()
		b.ReportAllocs()
		for i := 0; i < b.N; i++ {
			exp = types.DeriveSha(txs, trie.NewEmpty(trie.NewDatabase(rawdb.NewMemoryDatabase(), nil)))
		}
	})

	b.Run("stack_trie", func(b *testing.B) {
		b.ResetTimer()
		b.ReportAllocs()
		for i := 0; i < b.N; i++ {
			got = types.DeriveSha(txs, trie.NewStackTrie(nil))
		}
	})
	if got != exp {
		b.Errorf("got %x exp %x", got, exp)
	}
}

func TestFuzzDeriveSha(t *testing.T) {
	// increase this for longer runs -- it's set to quite low for travis
	rndSeed := mrand.Int()
	for i := 0; i < 10; i++ {
		seed := rndSeed + i
		exp := types.DeriveSha(newDummy(i), trie.NewEmpty(trie.NewDatabase(rawdb.NewMemoryDatabase(), nil)))
		got := types.DeriveSha(newDummy(i), trie.NewStackTrie(nil))
		if !bytes.Equal(got[:], exp[:]) {
			printList(newDummy(seed))
			t.Fatalf("seed %d: got %x exp %x", seed, got, exp)
		}
	}
}

// TestDerivableList contains testcases found via fuzzing
func TestDerivableList(t *testing.T) {
	type tcase []string
	tcs := []tcase{
		{
			"0xc041",
		},
		{
			"0xf04cf757812428b0763112efb33b6f4fad7deb445e",
			"0xf04cf757812428b0763112efb33b6f4fad7deb445e",
		},
		{
			"0xca410605310cdc3bb8d4977ae4f0143df54a724ed873457e2272f39d66e0460e971d9d",
			"0x6cd850eca0a7ac46bb1748d7b9cb88aa3bd21c57d852c28198ad8fa422c4595032e88a4494b4778b36b944fe47a52b8c5cd312910139dfcb4147ab8e972cc456bcb063f25dd78f54c4d34679e03142c42c662af52947d45bdb6e555751334ace76a5080ab5a0256a1d259855dfc5c0b8023b25befbb13fd3684f9f755cbd3d63544c78ee2001452dd54633a7593ade0b183891a0a4e9c7844e1254005fbe592b1b89149a502c24b6e1dca44c158aebedf01beae9c30cabe16a",
			"0x14abd5c47c0be87b0454596baad2",
			"0xca410605310cdc3bb8d4977ae4f0143df54a724ed873457e2272f39d66e0460e971d9d",
		},
	}
	for i, tc := range tcs[1:] {
		exp := types.DeriveSha(flatList(tc), trie.NewEmpty(trie.NewDatabase(rawdb.NewMemoryDatabase(), nil)))
		got := types.DeriveSha(flatList(tc), trie.NewStackTrie(nil))
		if !bytes.Equal(got[:], exp[:]) {
			t.Fatalf("case %d: got %x exp %x", i, got, exp)
		}
	}
}

func genTxs(num uint64) (types.Transactions, error) {
	key, err := pqcrypto.HexToMLDSA87("deadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef")
	if err != nil {
		return nil, err
	}
	var addr = pqcrypto.MLDSA87ToAddress(key)
	newTx := func(i uint64) (*types.Transaction, error) {
		signer := types.NewShanghaiSigner(big.NewInt(18))
		utx := types.NewTx(&types.DynamicFeeTx{
			Nonce:     i,
			To:        &addr,
			Value:     new(big.Int),
			Gas:       0,
			GasFeeCap: new(big.Int).SetUint64(10000000),
			Data:      nil,
		})
		tx, err := types.SignTx(utx, signer, key)
		return tx, err
	}
	var txs types.Transactions
	for i := uint64(0); i < num; i++ {
		tx, err := newTx(i)
		if err != nil {
			return nil, err
		}
		txs = append(txs, tx)
	}
	return txs, nil
}

type dummyDerivableList struct {
	len  int
	seed int
}

func newDummy(seed int) *dummyDerivableList {
	d := &dummyDerivableList{}
	src := mrand.NewSource(int64(seed))
	// don't use lists longer than 4K items
	d.len = int(src.Int63() & 0x0FFF)
	d.seed = seed
	return d
}

func (d *dummyDerivableList) Len() int {
	return d.len
}

func (d *dummyDerivableList) EncodeIndex(i int, w *bytes.Buffer) {
	src := mrand.NewSource(int64(d.seed + i))
	// max item size 256, at least 1 byte per item
	size := 1 + src.Int63()&0x00FF
	io.CopyN(w, mrand.New(src), size)
}

func printList(l types.DerivableList) {
	fmt.Printf("list length: %d\n", l.Len())
	fmt.Printf("{\n")
	for i := 0; i < l.Len(); i++ {
		var buf bytes.Buffer
		l.EncodeIndex(i, &buf)
		fmt.Printf("\"%#x\",\n", buf.Bytes())
	}
	fmt.Printf("},\n")
}

type flatList []string

func (f flatList) Len() int {
	return len(f)
}
func (f flatList) EncodeIndex(i int, w *bytes.Buffer) {
	w.Write(hexutil.MustDecode(f[i]))
}

type hashToHumanReadable struct {
	data []byte
}

func (d *hashToHumanReadable) Reset() {
	d.data = make([]byte, 0)
}

func (d *hashToHumanReadable) Update(i []byte, i2 []byte) error {
	l := fmt.Sprintf("%x %x\n", i, i2)
	d.data = append(d.data, []byte(l)...)
	return nil
}

func (d *hashToHumanReadable) Hash() common.Hash {
	return common.Hash{}
}
